<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<script src="/_resource/js/_js_initialLoadFiles.min.js"></script>
</head>
<body>

  <h1>C# DateTime的第一天、最後一天日期求取</h1>

  <p>大概就是上個月的第一天，這個月的最後一天、下個月的最後一天一天之類的需求，把程式碼整理在此供給有需要的人參考。</p>

<pre class="C#">
System.DateTime dNow = System.Convert.ToDateTime("2021/02/15 12:34:56");

Console.WriteLine($"現在參考時間：{dNow}");
Console.WriteLine($"上個月第一天：{dNow.AddDays(dNow.Day * -1).Date.AddMonths(-1).AddDays(1)}");
Console.WriteLine($"上個月最末天：{dNow.AddDays(dNow.Day * -1).AddDays(1).Date.AddMilliseconds(-1)}");
Console.WriteLine($"這個月第一天：{dNow.AddDays(dNow.Day * -1).AddDays(1).Date}");
Console.WriteLine($"這個月最末天：{dNow.AddDays(dNow.Day * -1).AddDays(1).Date.AddMonths(1).AddMilliseconds(-1)}");
Console.WriteLine($"下個月第一天：{dNow.AddDays(dNow.Day * -1).AddDays(1).AddMonths(1).Date}");
Console.WriteLine($"下個月最末天：{dNow.AddDays(dNow.Day * -1).AddDays(1).AddMonths(2).Date.AddMilliseconds(-1)}");
</pre>

<p>輸出訊息：</p>

<pre class="plaintext">
現在參考時間：02/15/2021 12:34:56
上個月第一天：01/01/2021 00:00:00
上個月最末天：01/31/2021 23:59:59
這個月第一天：02/01/2021 00:00:00
這個月最末天：02/28/2021 23:59:59
下個月第一天：03/01/2021 00:00:00
下個月最末天：03/31/2021 23:59:59
</pre>

<small>上個月第一天 上個月最末天 上個月最後一天 這個月第一天 這個月最末天 這個月最後一天 下個月第一天 下個月最末天 下個月最後一天</small>
         
</body>  
</html>  
         
         
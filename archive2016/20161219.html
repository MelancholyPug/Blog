<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<script src="/_resource/js/_js_initialLoadFiles.min.js"></script>
</head>
<body>

<h1>申請、安裝與更新IIS內的SSL憑證（2048 Bits）</h1>

<p>前一陣子又在處理Microsoft IIS裡面的SSL憑證，想說沒有好好地寫過一篇IIS申請安裝SSL的文章，趁著這一次的憑證更新，將所有的過程記錄下來，分享給大家。這篇文章的基礎點是已經擁有既有的SSL憑證，基於這個基礎上再去重新申請一次新的憑證並且安裝。因此，對於一個從來沒有SSL憑證的IIS，也是極具有參考價值的。</p>

<h3>伺服器憑證的申請</h3>

<p>Step 1. 打開IIS，點選IIS根目錄，點選伺服器憑證。</p>
<img src="/image/2016/20161219_01.jpg" />

<p>Step 2. 點選建立憑證要求</p>
<img src="/image/2016/20161219_02.jpg" />

<p>Step 3. 填寫這張憑證的可視資訊，建議盡量越真實越好。</p>
<img src="/image/2016/20161219_03.jpg" />

<p>Step 4. 密碼編譯服務提供者選取Microsoft RSA SChannel Cryptographic Provider，位元長度選2048 Bits。</p>
<img src="/image/2016/20161219_04.jpg" />

<p>Step 5. 取得到憑證要求檔案（CERTIFICATE REQUEST），這個檔案會以BASE64進行編碼，請指定到該要求檔案要存放的路徑。</p>
<img src="/image/2016/20161219_05.jpg" />

<p>之後，請將憑證要求檔案依照GCA、Verisign等憑證供應中心的規範提出申請，這邊就不再贅述。</p>

<h3>伺服器憑證的安裝（與更新）</h3>

<p>進行這個步驟之前，請先確定您已經從憑證供應中心取得到憑證檔案（.cer），這個檔案會是以二進制的方式存在。</p>

<p>Step 6. 打開IIS進入到根目錄，點選伺服器憑證。</p>
<img src="/image/2016/20161219_06.jpg" />

<p>Step 7. 點選「完成憑證要求」。</p>
<img src="/image/2016/20161219_07.jpg" />

<p>Step 8. 請選擇.cer檔案存放的路徑，並賦予這個憑證一個容易記住的名稱（建議用日期來區分最佳）。</p>
<img src="/image/2016/20161219_08.jpg" />

<p>Step 9. 回到IIS，點選要套用憑證的網站，點選繫結。</p>
<img src="/image/2016/20161219_09.jpg" />

<p>Step 10. 點選https的標準Port 443，點選編輯。</p>
<img src="/image/2016/20161219_10.jpg" />

<p>Step 11. 下拉選擇SSL憑證，選到你剛才命名的SSL憑證。</p>
<img src="/image/2016/20161219_11.jpg" />

<p>Step 12. 沒問題後就一路關閉啦！恭喜你憑證已經設定成功。</p>
<img src="/image/2016/20161219_12.jpg" />

<h3>檢查伺服器憑證的有效性</h3>

<p>回到瀏覽器端來檢查之前舊憑證的日期，發現到2017年01月就過期了。</p>
<img src="/image/2016/20161219_13.jpg" />

<p>更新後的憑證，到期時間已經來到2019年12月了，這代表你的網站的憑證已經新增/更新成功。</p>
<img src="/image/2016/20161219_14.jpg" />

<small>Microsoft Windows Server IIS SSL Request Install Renewal GCA VeriSign OpenSSL</small>

</body>
</html>